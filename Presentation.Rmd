---
title: "The Darkened Band"
author: "Austin Meyer"
date: "3/20/2019"
output: ioslides_presentation
css: styles.css
smaller: true
runtime: shiny
widescreen: true
logo: figures/logo.png
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Initial presentation

## Initial presentation

- <font size="5">59 yo female with morbid obesity, chronic vertigo, hypertension, and a recent episode of necrotizing fasciitis to the mons pubis. She presented as a transfer from SNF for hypotension.</font>

> - <font size="4">Since her hospitalization at OSUE she had been in a SNF recovering. She was having chronic diarrhea and poor PO intake which was worse over the past week with frequent NBNB emesis and watery diarrhea.</font>

> - <font size="4">Routine vitals done at SNF. She was hypotensive to 80s systolic. She was seen at MCH where she was still hypotensive (lowest 79/46), and was reportedly febrile. She was bolused 2L NS and started on phenylephrine. There was concern for UTI based on urinalysis (had indwelling foley, last changed 1 week prior) and was started on Cefepime. Labs significant for AKI and troponin.</font>

> - <font size="5">On arrival, the patient reported some nausea and then had a somewhat bilious emesis. Denied symptoms other than normal vertigo.</font>

# Differential?

## Vitals on arrival

BP = 107/67<br><br>
HR = 106<br><br>
SpO2 = 95% on RA<br><br>
RR = 26<br><br>
Temp = 99.3<br><br>
Drips = phenyleprine at 0.5 mcg/kg/min

## Physical exam

- AOx4, No distress, Overweight, Laying in bed
- Cardiopulmonary exam was wnl
- Mild epigastric tenderness
- Foley in place
<br><br><br><br>
- Site of prior debridement of left groin with healthy granulation tissue. 
- I&D site on right lower abdomen with packing in place without drainage. 
- Over the right upper abdomen there are clusters of vesicles that appear to be crusted over in the region of T6 dermatome on the right. 

# Things to order?

## Initial labs

- Na 141, K 4.6, Cl 110, HCO3 17, Cr 1.2<br><br>
- LFTs wnl<br><br>
- Trop 0.4<br><br>
- WBC 9.6, Hgb 11.8, Plt 341<br><br>
- Lactate 1.4

## Imaging

- Chest xr: 
<font size="4"><br>Life support devices as described above. No acute cardiopulmonary findings.</font>

- CT A/P: <br>
<font size="4">1.) Previously described ill-defined region of stranding and gas within the perineum is nonvisualized on today's exam, likely out of the field-of-view <br>
2.) Multiple nonspecific prominent para-aortic, pelvic sidewall, and inguinal lymph nodes are stable-slightly decreased in size from the prior exam. <br>
3.) Cholelithiasis. No specific evidence of acute cholecystitis. <br>
4.) Multiple bilateral hyperdense renal cystic lesions, some of which are new from the prior exam. These are incompletely characterized and may represent hemorrhagic/proteinaceous cysts. Underlying renal neoplasia cannot be excluded on this exam. <br>
5.) Circumferential urinary bladder wall thickening may in part be related to underdistention. Consider correlation with urinalysis to exclude acute cystitis. <br></font>

## Updates and what was done...

> - Became a bit hypotensive so bolused 1L and phenylephrine increased to 1 mcg/kg/min<br><br>
> - Started on broad antibiotics including dapto, cefepime, flagyl, acyclovir<br><br>
> - After one dose of cefepime and flagyl, switched to merrem<br><br>
> - After one dose of acyclovir switched to valtrex<br><br>
> - Temp increased to 100.3 overnight

# Day one 

## Day one update

> - NAE, still on phenylephrine at stable dose<br><br>

> - Phenylephrine quickly weaned off in the morning and pt went hypotensive <br>__Started on levophed__

> - Vitals: <br>&nbsp;&nbsp;- HR 101 <br>&nbsp;&nbsp;- MAPs consistently around 65 <br>&nbsp;&nbsp;- RR 18-24 <br>&nbsp;&nbsp;- Temp 100.2 <br>&nbsp;&nbsp;- RA 

> - Exam: AOx4, NAD, Seems completely fine, Eating normally

## More information from prior hospitalization

- __Candida glabrata__ at high CFU in urine<br><br>
- __Lactobacillus gasseri__ on anaerobic of mons pubis wound<br><br>
- __Candida glabrata__ on fungal of mons pubis wound<br><br>
- Various __ESBL bugs__ on standard culture of mons pubis wound

## Day one findings

- Na 142, K 4.2, Cl 111, HCO3 19, Cr 1.1
- Trop peaked at 0.42
- WBC 13.4 w/ left shift, Hgb 11.3, Plt 390
- Lactate 1.8 -> 2.0 -> 1.4
<br><br>
- POC flu negative
- Procal 0.09, CRP 13.3, ESR 11
- UA off exchanged foley: <br>&nbsp;&nbsp;- Turbid, Large Blood, >20 WBCs, Small LE, Nitrites negative
- EKG with left axis deviation and RBBB similar to EKG on prior admisison

# Refine differential, orders?

# Day two

## Day two update

- NAE, levophed weaned to 0.02 mg/kg/min overnight

> - Levophed requirement increased back to 0.08 mg/kg/min

> - Vitals: <br>&nbsp;&nbsp;- HR 95 <br>&nbsp;&nbsp;- MAPs are variable <br>&nbsp;&nbsp;- RR 20-33 <br>&nbsp;&nbsp;- Temp 98 <br>&nbsp;&nbsp;- SpO2 92% on RA 

> - Exam: AOx4, NAD, Still completely fine

> - Management: Started pt on caspofungin for Candida on last admission

## Day two labs

- Na 137, K 4.0, Cl 111, HCO3 18, Cr 0.99<br><br>
- Trop stopped prior day<br><br>
- WBC 9, Hgb 9.8, Plt 318<br><br>
- Lactate stopped prior day<br><br>
- Blood cx: NGTD

# Refine differential, orders?

# Day three

## Day three updates

> - NAE, levophed stable at about 0.1 mg/kg/min, unable to wean<br><br>
> - Vitals: Unchanged<br><br>
> - Drips: Still requiring 0.07 mcg/kg/min to maintain MAPs > 65<br><br>
> - Exam: AOx4, NAD, Still completely fine

## Day three labs

- Na 138, K 3.7, Cl 111, HCO3 18, Cr 0.84<br><br>
- WBC 7.6, Hgb 9.4, Plt 297<br><br>
- Blood cx: NGTD

# Final thoughts?

## New imaging

> - TTE: <font size="4"><br>&nbsp;&nbsp;Overall image quality is good. Tachycardic during exam. <br>&nbsp;&nbsp;The LV chamber size is small, partially compressed by the RV. <br>&nbsp;&nbsp;Systolic function is hyperdynamic, EF >70% <br>&nbsp;&nbsp;The right ventricle is severely enlarged (RV : LV ratio is 1.5-2 : 1). <br>&nbsp;&nbsp;There is severe RV dysfunction.  <br>&nbsp;&nbsp;Septal motion is consistent with right ventricular pressure and volume overload. <br>&nbsp;&nbsp;There is free wall hypokinesis. <br>&nbsp;&nbsp;There is mild-to-moderate tricuspid regurgitation <br>&nbsp;&nbsp;There is aortic sclerosis without stenosis. <br>&nbsp;&nbsp;Moderately elevated pulmonary pressures, estimated RVSP 60-65 mmHg. <br>&nbsp;&nbsp;Small pericardial effusion without echocardiographic evidence of tamponade. <br>&nbsp;&nbsp;No evidence of right to left shunt by saline bubble study.</font>

##

```{r out.width = "65%", fig.align="center"}
library(knitr)    # For knitting document and include_graphics function
library(ggplot2)  # For plotting
library(png)      # For grabbing the dimensions of png files

img1_path <- "figures/PE_1.png"
include_graphics(img1_path)
```

##

```{r out.width = "65%", fig.align="center"}
library(knitr)    # For knitting document and include_graphics function
library(ggplot2)  # For plotting
library(png)      # For grabbing the dimensions of png files

img1_path <- "figures/PE_2.png"
include_graphics(img1_path)
```

##

```{r out.width = "60%", fig.align="center"}
library(knitr)    # For knitting document and include_graphics function
library(ggplot2)  # For plotting
library(png)      # For grabbing the dimensions of png files

img1_path <- "figures/PE_3.png"
include_graphics(img1_path)
```

## 

```{r out.width = "55%", fig.align="center"}
library(knitr)    # For knitting document and include_graphics function
library(ggplot2)  # For plotting
library(png)      # For grabbing the dimensions of png files

img1_path <- "figures/PE_4.png"
include_graphics(img1_path)
```

# Final Dx: Massive PE

# So... what happened here?

##

<p style="text-align:center">
<object type="image/svg+xml" data="figures/Cognitive_bias_codex_en.svg" height="500px">
<!-- Your fall back here -->
<img src="figures/Cognitive_bias_codex_en.svg" height="500px"/>
</object>
</p>

# Teaching part

## Quick facts about PE

> - Prevalence is 1-2 per 1000 in the general population <font size='4'><br>&nbsp;&nbsp;- Wells 2: PE based on clinical gastault alone was 86/930 = 9.2% <br>&nbsp;&nbsp;- Studies are often stratified by > or < 20% prevalence!!</font>

> - PESIT: PE was identified in nearly 1/6 patients hospitalized for first syncope.

> - Most PEs occur in people > 60 years of age

> - Mortality of undiagnosed PE may be 30% vs. 8% mortality when treated

> - Even in submassive PE the mortality is 5-25% depending on study

> - 1/3 of people will have recurrence of VTE within 10 years

> - In US, 5-8% have at least one genetic risk factor

## Probability of pulmonary embolism w/ CPR

```{r, echo = FALSE}
library(tibble)
library(ggplot2)
library(shinyWidgets)

fluidPage(
  fluidRow(
    column(5,
           checkboxGroupButtons("wells1", label = h3("Wells Criteria", style = 'line-height: 0'),
                                direction = 'vertical',
                                choices = list("Clinical signs or symptoms of DVT" = 3, 
                                               "PE is #1 diagnosis" = 3, 
                                               "Heart rate > 100" = 1.5,
                                               "Immobilization >= 3 days or surgery in last 4 weeks" = 1.5, 
                                               "Previous objective PE or DVT" = 1.5, 
                                               "Hemoptysis" = 1,
                                               "Cancer and treatment in last 6 months" = 1
                                ),
                                selected = 0),
           hr(),
           radioGroupButtons("ddimer", label = h3("D-dimer > 500 µg/L", style = 'line-height: 0'), 
                             choices = list('Yes' = 'positive', 'No' = 'negative', 'Not available' = 'NA'),
                             selected = 'NA')
    ),
    
    column(7,
           plotOutput('probPlot1', width="500px", height="410px"), 
           textOutput('probText1'),  
           align = 'right')
  )
)


output$probText1 <- renderText({
  points <- sum(as.numeric(input$wells1))
  prob <- if(points < 3) 0.06 else if( points < 7 ) 0.23 else 0.49
  
  lr <- if(input$ddimer == 'NA') 1 else if(input$ddimer == 'positive') 0.91 / (1 - 0.6) else if(input$ddimer == 'negative') (1 - 0.91) / 0.6
  
  posttest.odds <- prob / (1 - prob) * lr
  posttest.prob <- round(posttest.odds / (1 + posttest.odds) * 100, 2)
  
  paste('Probability of PE = ', posttest.prob, '%', sep = '')
})

output$probPlot1 <- renderPlot({
  points <- sum(as.numeric(input$wells1))
  prob <- if(points < 3) 0.06 else if( points < 7 ) 0.23 else 0.49
  
  lr <- if(input$ddimer == 'NA') 1 else if(input$ddimer == 'positive') 0.91 / (1 - 0.6) else if(input$ddimer == 'negative') (1 - 0.91) / 0.6
  
  posttest.odds <- prob / (1 - prob) * lr
  posttest.prob <- posttest.odds / (1 + posttest.odds)
  
  df <- tibble(x = factor(c('Pretest', 'Posttest'), levels = c('Pretest', 'Posttest')), y = c(prob, posttest.prob))
  
  ggplot(df, aes(x = x, y = y)) + geom_bar(stat = 'identity') + 
    labs(x = '', y = '') +
    theme_classic() + 
    ylim(0,1) + 
    ylab('Fractional Probability') +
    theme(plot.margin = unit(c(0,0,-0.5,0), "lines"))
})

```

<font size="1">Ceriani E, et al. Clinical prediction rules for pulmonary embolism: a systematic review and meta‐analysis. Journal of thrombosis and haemostasis. 2010, 8:957-70.</font><br>
<font size="1">Crawford F, et al. D‐dimer test for excluding the diagnosis of pulmonary embolism. Cochrane Database of Systematic Reviews. 2016, 8.</font>

## So.. What is the gold standard?

<center><img src="figures/house.gif" width='800px' /></center>

## The gold standard is unclear, actually

> - <font size='4'>Wells 1 (1998): "Pulmonary angiography is the gold standard diagnostic test..."</font>
> - <font size='4'>Wells 2 (2001): "Patients with nondiagnostic scans and equivocal ultrasonography results had gold- standard testing-pulmonary angiography and venography..."</font>
<br><br>
> - <font size='4'>PIOPED 2 (2006): "Ventilation–perfusion lung scanning showing a high probability of pulmonary embolism in a patient with no history of pulmonary embolism, abnormal findings on pulmonary DSA, or abnormal findings on venous ultrasonography in a patient without previous deep venous thrombosis at that site and nondiagnostic results on ventilation–perfusion scanning (not normal and not high probability without previous pulmonary embolism). Abnormal venous ultrasonography in such a patient was interpreted as a surrogate for the diagnosis of pulmonary embolism."</font>

## Should we rely CT PE?

- <font size='4'>"We intended to study the performance of CTPA in all patients in whom this imaging modality is required to rule out PE. For this reason, our study patients had an overall moderate probability of having PE (28%). It could be reasoned that the NPV of the CTPA is lower in more selected patients with a high clinical probability than in the population that we studied here."</font>

> - <font size='4'>"In our analysis, it was not possible to study this issue in more detail, as none of the included studies had reported the incidence of symptomatic VTE after a normal CTPA result alone in a selection of high‐probability patients only."</font>

> - <font size='4'>"It is of note that in the recent guidelines of the European Society of Cardiology on the diagnosis of acute PE, the safe exclusion of PE in a high clinical probability population by a normal CTPA result alone is being debated because of the possibility of false‐negative CTPA results"</font>

<font size="1">Robert‐Ebadi H, et al. Safety of multidetector computed tomography pulmonary angiography to exclude pulmonary embolism in patients with a likely pretest clinical probability. Journal of Thrombosis and Haemostasis. 2017, 15:1584-90.</font>

## We can address this problem...

```{r, echo = FALSE}
library(tibble)
library(ggplot2)
library(shinyWidgets)

fluidPage(
  fluidRow(
    column(5,
           checkboxGroupButtons("wells2", label = h3("Wells Criteria", style = 'line-height: 0'),
                                direction = 'vertical',
                                choices = list("Clinical signs or symptoms of DVT" = 3, 
                                               "PE is #1 diagnosis" = 3, 
                                               "Heart rate > 100" = 1.5,
                                               "Immobilization >= 3 days or surgery in last 4 weeks" = 1.5, 
                                               "Previous objective PE or DVT" = 1.5, 
                                               "Hemoptysis" = 1,
                                               "Cancer and treatment in last 6 months" = 1
                                ),
                                selected = 0),
           hr(),
           radioGroupButtons("ctpe", label = h3("CT PE positive", style = 'line-height: 0'), 
                             choices = list('Yes' = 'positive', 'No' = 'negative', 'Not available' = 'NA'),
                             selected = 'NA')
    ),
    
    column(7,
           plotOutput('probPlot2', width="500px", height="410px"), 
           textOutput('probText2'),  
           align = 'right')
  )
)


output$probText2 <- renderText({
  points <- sum(as.numeric(input$wells2))
  prob <- if(points < 3) 0.06 else if( points < 7 ) 0.23 else 0.49
  
  lr <- if(input$ctpe == 'NA') 1 else if(input$ctpe == 'positive') 0.83 / (1 - 0.96) else if(input$ctpe == 'negative') (1 - 0.83) / 0.96
  
  posttest.odds <- prob / (1 - prob) * lr
  posttest.prob <- round(posttest.odds / (1 + posttest.odds) * 100, 2)
  
  paste('Probability of PE = ', posttest.prob, '%', sep = '')
})

output$probPlot2 <- renderPlot({
  points <- sum(as.numeric(input$wells2))
  prob <- if(points < 3) 0.06 else if( points < 7 ) 0.23 else 0.49
  
  lr <- if(input$ctpe == 'NA') 1 else if(input$ctpe == 'positive') 0.83 / (1 - 0.96) else if(input$ctpe == 'negative') (1 - 0.83) / 0.96
  
  posttest.odds <- prob / (1 - prob) * lr
  posttest.prob <- posttest.odds / (1 + posttest.odds)
  
  df <- tibble(x = factor(c('Pretest', 'Posttest'), levels = c('Pretest', 'Posttest')), y = c(prob, posttest.prob))
  
  ggplot(df, aes(x = x, y = y)) + geom_bar(stat = 'identity') + 
    labs(x = '', y = '') +
    theme_classic() + 
    ylim(0,1) + 
    ylab('Fractional Probability') +
    theme(plot.margin = unit(c(0,0,-0.5,0), "lines"))
})

```

<font size="1">Stein PD, et al. Multidetector computed tomography for acute pulmonary embolism. New England Journal of Medicine. 2006, 354:2317-27.</font><br>

# Go forth and find PEs